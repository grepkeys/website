<!DOCTYPE html>
<html lang="en-au">
  <head>
    {{ partial "head" . }}
    {{ partial "title" . }}
  </head>

  <body>
    {{ partial "nav" . }}
    <header><span>{{ .Title }}</span></header>

    <main class="cards">
      <!-- Slice of all the pages that are to use the smaller two-column -->
      <!-- card format -->
      {{ $smallcardpages := slice "switches" }}

      {{ range .Pages }}
        <div class="
          card
          {{ if in $smallcardpages .Section }}
            smallcard
          {{ end }}
        ">
          <a class="cardlink" href="{{ .Permalink }}">
            <!-- Image format for e.g. -->
            <!--   /content/keyboards/applewirelesskeyboard.md -->
            <!-- is -->
            <!--   /assets/img/applewirelesskeyboard.md -->
            {{ $path := (printf "img/%s.jpg" .File.BaseFileName) }}
            {{ if fileExists (printf "/assets/%s" $path) }}
              {{ $img := resources.Get $path }}

              <!-- Use imageConfig function to extract aspect ratio of -->
              <!-- original image -->
              {{ $imgdata := imageConfig (printf "/assets/%s" $path) }}
              {{ $imgaspect := div (float $imgdata.Height) $imgdata.Width }}

              <!-- Use padding-top hack to create a wrapper div around each -->
              <!-- image that has a fixed aspect ratio the same as the -->
              <!-- image. This means that the layout doesn't jump around as  -->
              <!-- images load -->
              <!-- -->
              <!-- The - 0.2 removes some small amount that for some reason the -->
              <!-- browser adds -- without it the wrapper is too tall. I also -->
              <!-- don't know why. -->
              <div
                class="imgwrapper"
                style="padding-top: {{ sub (mul $imgaspect 100) 0.2 }}%"
              >
                <!-- Make card images lower res if we are in two-column -->
                <!-- layout -->
                {{ if in $smallcardpages .Section }}
                  <img src='{{ ($img.Resize "256x").Permalink }}'>
                {{ else }}
                  <img src='{{ ($img.Resize "512x").Permalink }}'>
                {{ end }}
              </div>
            {{ end }}

            <p class="cardtitle">{{ .Title }}</p>
          </a>
        </div>
      {{ end }}
    </main>

    {{ partial "footer" . }}
  </body>
</html>
